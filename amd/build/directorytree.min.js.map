{"version":3,"file":"directorytree.min.js","sources":["../src/directorytree.js"],"sourcesContent":["import $ from 'jquery';\nimport 'assignsubmission_noto/jstree';\nimport ajax from 'core/ajax';\nimport notification from 'core/notification';\nexport const init = (courseid, apinotebookpath, redirecttonoto_string) => {\n    $(function () {\n        var promises = ajax.call([\n            { methodname: 'assignsubmission_noto_get_jstree_json', args: { courseid: courseid} },\n        ]);\n        promises[0].done(function(response) {\n            if (response.warnings.length > 0) {\n                let warnings = '';\n                response.warnings.every(function(w) {\n                    warnings += w.warningcode + ': '+ w.message + '</br>';\n                });\n                $('#jstree').html(warnings);\n            } else {\n                var src = jQuery.parseJSON(response.result);\n                $('#jstree').jstree({ 'core' : {\n                        'data' : src\n                    }});\n                $(\"#assignsubmission_noto_directory\").val(\"\");\n                $(\"#assignsubmission_noto_directory_h\").val(\"\");\n                $('#jstree').on(\"changed.jstree\", function (e, data) {\n                    $(\"#assignsubmission_noto_directory\").val(data.selected);\n                    $(\"#assignsubmission_noto_path\").html(data.selected);\n                    $(\"#assignsubmission_noto_redirect\").html('<a href=\"' + apinotebookpath + data.selected + '\" target=\"_blank\">'+redirecttonoto_string+'</a>');\n                    $(\"#assignsubmission_noto_directory_h\").val(data.selected);\n                });\n            }\n        }).fail(function(ex) {\n            notification.exception(ex);\n        });\n\n        $(\"#assignsubmission_noto_reloadtree_submit\").on('click', function(e) {\n            e.preventDefault();\n            var refreshpromises = ajax.call([\n                { methodname: 'assignsubmission_noto_get_jstree_json', args: { courseid: courseid} },\n            ]);\n            refreshpromises[0].done(function(response) {\n                var src = jQuery.parseJSON(response.result);\n                if (src) {\n                    $('#jstree').jstree(true).settings.core.data = src;\n                    $('#jstree').jstree(true).refresh();\n                }\n            }).fail(function(ex) {\n                notification.exception(ex);\n            });\n        });\n    });\n};\n"],"names":["courseid","apinotebookpath","redirecttonoto_string","ajax","call","methodname","args","done","response","warnings","length","every","w","warningcode","message","html","src","jQuery","parseJSON","result","jstree","val","on","e","data","selected","fail","ex","exception","preventDefault","settings","core","refresh"],"mappings":"seAIoB,CAACA,SAAUC,gBAAiBC,8CAC1C,WACiBC,cAAKC,KAAK,CACrB,CAAEC,WAAY,wCAAyCC,KAAM,CAAEN,SAAUA,aAEpE,GAAGO,MAAK,SAASC,aAClBA,SAASC,SAASC,OAAS,EAAG,KAC1BD,SAAW,GACfD,SAASC,SAASE,OAAM,SAASC,GAC7BH,UAAYG,EAAEC,YAAc,KAAMD,EAAEE,QAAU,+BAEhD,WAAWC,KAAKN,cACf,KACCO,IAAMC,OAAOC,UAAUV,SAASW,4BAClC,WAAWC,OAAO,MAAW,MACdJ,2BAEf,oCAAoCK,IAAI,wBACxC,sCAAsCA,IAAI,wBAC1C,WAAWC,GAAG,kBAAkB,SAAUC,EAAGC,0BACzC,oCAAoCH,IAAIG,KAAKC,8BAC7C,+BAA+BV,KAAKS,KAAKC,8BACzC,mCAAmCV,KAAK,YAAcd,gBAAkBuB,KAAKC,SAAW,qBAAqBvB,sBAAsB,4BACnI,sCAAsCmB,IAAIG,KAAKC,iBAG1DC,MAAK,SAASC,0BACAC,UAAUD,2BAGzB,4CAA4CL,GAAG,SAAS,SAASC,GAC/DA,EAAEM,iBACoB1B,cAAKC,KAAK,CAC5B,CAAEC,WAAY,wCAAyCC,KAAM,CAAEN,SAAUA,aAE7D,GAAGO,MAAK,SAASC,cACzBQ,IAAMC,OAAOC,UAAUV,SAASW,QAChCH,0BACE,WAAWI,QAAO,GAAMU,SAASC,KAAKP,KAAOR,wBAC7C,WAAWI,QAAO,GAAMY,cAE/BN,MAAK,SAASC,0BACAC,UAAUD"}